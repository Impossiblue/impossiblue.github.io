<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Impossiblue: PHP - How to find pathnames matching a pattern</title><meta name="description" content="The PHP glob function finds path names according to a pattern. Error messages can be suppressed, if so wished. It is also possible to count the number of matching files in a directory. Use PHP to pick a random file from an array of matching files and display the contents of a text file."><meta name="author" content="https://impossiblue.github.io"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Impossiblue"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="apple-touch-icon" sizes="152x152" href="../../touch-icon-ipad.png"><link rel="apple-touch-startup-image" media="(device-width:768px) and (device-height:1024px) and (-webkit-device-pixel-ratio:2) and (orientation:portrait)" href="../../start-up-1536x2008.png"><link rel="apple-touch-startup-image" media="(device-width:768px) and (device-height:1024px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="../../start-up-1496x2048.png"><link rel="stylesheet" href="../../css/i.css"><!--[if lt IE 10]><link rel="stylesheet" href="../../css/ie.css"><![endif]--><style>aside::after{content:"5 March, 2017";}h2+p{color:rgba(0,0,0,.24);}.echo{margin:1.5em 0 .5em;border:1px solid #eef5df;padding:.75em 1em;color:#eef5df;background-color:rgba(0,0,0,.24);}</style></head><body><div id="ie">With geriatric Internet Explorer versions this site looks shite. This because Impossiblue is built with modern tools and would require hacks and workarounds to function in legacy browsers. I no longer have the patience nor the inclination to satisfy everybody. Impossiblue is an experiment and a playground &#8211;&#160;and my sustenance does not depend on it. As a concequence &#8211;&#160;to embarrass nobody &#8211;&#160;I have decided to lock you out. So, there.</div><div id="wrapper"><aside>16</aside><header id="masthead"><h1><a href="../../index.html">Impossiblue</a></h1></header><nav><button class="goEast" title="Menu">Open menu<div></div></button><a id="at" class="goEast" href="../../form.html" title="Contact us">Open form</a><ul>
<li class="ctgr"><b>&#9662;&#8194;</b><strong>Lorem ipsums</strong></li>
<li><a href="../210326/index.html">Google&#8217;s material icons</a></li>
<li><a href="../210310/index.html">The secret six</a></li>
<li><a href="../210305/index.html">CSS background &#8211; Part 1</a></li>
<li><a href="../210325/index.html">CSS background &#8211; Part 2</a></li>
<li><a href="../170505/index.html">A pure CSS modal window</a></li>
<li><a href="../170420-2/index.html"><code>box-shadow</code></a></li>
<li><a href="../170414/index.html">Putting the &#8220;Checkbox hack&#8221; to good use</a></li>
<li><a href="../170420/index.html">Greyscale</a></li>
<li><a href="../170404-2/index.html">Sepia</a></li>
<li><a href="../170404/index.html">Background gradients</a></li>
<li><a href="../170326/index.html">Pseudo-elements and the image tag</a></li>
<li><a href="../170308/index.html">Styling an HTML <code>input</code> element</a></li>
<li><a href="../150504/index.html">How to add and centre a custom iPad wallpaper</a></li>
<li><a href="../150421-2/index.html">How to make a screen dump on an iPad</a></li>
<li><a href="../150421/index.html">How to permanently delete pictures from an iPad</a></li>
<li><a href="../140502/index.html">PHP &#8211; Random image</a></li>
<li><a href="../140426/index.html">PHP &#8211; How to get the width and height of an image</a></li>
<li><a href="../140423/index.html">PHP &#8211; Random quote</a></li>
<li id="crrnt"><b>&#9656;&#8194;</b>PHP &#8211; How to find pathnames matching a pattern</li>
<li><a href="../141026/index.html">How to design a close-button with CSS</a></li>
<li><a href="../140625/index.html">Film grain &#8211; Sort of</a></li>
<li><a href="../140528/index.html">Noisy canvas &#8211; Dynamic</a></li>
<li><a href="../140328/index.html">How to create a composite layer in Photoshop</a></li>
<li><a href="../140312/index.html">Noisy background &#8211; Static</a></li>
<li><a href="../100828/index.html">How to crop a movie with QuickTime Pro</a></li>
<li><a href="../060216/index.html">Gradient mosaic</a></li>
<li class="ctgr"><b>&#9662;&#8194;</b><strong>Rants and raves</strong></li>
<li><a href="../170417-2/index.html"><code>clip-path</code> &#8211; Part 2</a></li>
<li><a href="../170417/index.html"><code>clip-path</code> &#8211; Part 1</a></li>
<li><a href="../170322/index.html">Rapha&#235;l or Thinking outside the box</a></li>
<li><a href="../150907/index.html">Jan Kj√¶rstad &#8211;&#160;Storyteller</a></li>
<li><a href="../150504-2/index.html">Rain on a window pane &#8211;&#160;JavaScript simulation</a></li>
<li><a href="../170315/index.html">CSS throbbers &#8211;&#160;Part 3</a></li>
<li><a href="../150503/index.html">CSS throbbers &#8211;&#160;Part 2</a></li>
<li><a href="../150407/index.html">CSS throbbers &#8211;&#160;Part 1</a></li>
<li><a href="../150406/index.html">ResEdit and the recreation of the Mac OS wristwatch cursor animation</a></li>
<li><a href="../141108/index.html">Kaja Norum</a></li>
<li><a href="../141010/index.html">Kurt &#38; Kara <i>c</i> 1984</a></li>
<li><a href="../140627/index.html">Canvas and the Close Pixelate script</a></li>
<li><a href="../140405/index.html">Web Audio API &#8211; 1st Approach</a></li>
<li><a href="../140329/index.html">Audio visualizer &#8211; Atomic</a></li>
<li><a href="../140329/starfield.html">Audio visualizer &#8211; Star field</a></li>
<li><a href="../140323/index.html">Flash <i>in memoriam</i></a></li>
<li class="ctgr"><b>&#9662;&#8194;</b><strong>Notes to self</strong></li>
<li><a href="../150504-3/index.html">Ordnance Survey map of Great Britain</a></li>
<li><a href="../170530/index.html">Linking from SVG</a></li>
<li><a href="../170506/index.html">SVG in HTML and CSS</a></li>
<li><a href="../170429/index.html">Resize video <i>in situ</i></a></li>
<li><a href="../170425/index.html">Testing jQuery UI <code>draggable()</code></a></li>
<li><a href="../170424/index.html"><code>backdrop-filter: blur()</code></a></li>
<li><a href="../170422/index.html">Testing <code>sketch.js</code> &#8211;&#160;Particles</a></li>
<li><a href="../170404-3/index.html">Responsive images</a></li>
<li><a href="../170313/index.html">Pure CSS shapes</a></li>
<li><a href="../210308/index.html">A CSS TV-screen</a></li>
<li><a href="../170307/index.html">q</a></li>
<li><a href="../150511/index.html">xStand for iPad &#8211;&#160;The missing user manual</a></li>
<li><a href="../140628/index.html">CSS blur animation</a></li>
<li><a href="../150501/index.html">The CSS rule</a></li>
<li><a href="../170408/index.html">On forms and tables</a></li>
<li><a href="../140319/index.html">On animated cursors</a></li>
<li><a href="../150618/index.html">The concerts</a></li>
</ul></nav><article><h2>PHP &#8211; How to find pathnames matching a pattern</h2><p>First published on Ka of Isis 140420</p><p><span class="nb">Note: </span>As <code>github.io</code> (where this website lives) does not support PHP, the results shown in this article, are simulations.</p><p class="drpcp">According to the <a href="http://php.net/manual/en/function.glob.php">PHP manual</a>, the <code>glob()</code> function searches for all the pathnames matching a pattern and returns an array containing the matched files/directories, an empty array if no file matched, or <code>false</code> on error. As an example, the following code will search for &#8211;&#160;and build an array of &#8211;&#160;text files in a given directory and display file names and their corresponding file sizes concatenated on separate lines:</p><pre><code class="php">foreach (glob("*.txt") as $filename) {
	echo "$filename (" . filesize($filename) . " bytes)&lt;br&gt;";
}</code></pre><p>Testing this live with three plain text files stored in the same directory as this article is stored, the result is:</p><p class="echo">file-1.txt (136 bytes)<br>file-2.txt (262 bytes)<br>file-3.txt (1668 bytes)<br></p><p>On some systems, however, it is impossible to distinguish between an empty match and an error. If no matching files are found, either nothing will be displayed or a message will be generated. In a comment to the PHP manual, an anonymous user states that the <code>glob</code> function result will only be an array if it finds some files, and the <code>foreach</code> statement requires its argument to be an array. By checking for the possibility that the result of the <code>glob</code> function may <em>not</em> be an array, the warning can be eliminated.</p><p>He/she suggests a modified script:</p><pre><code class="php">$matches = glob("*.txt");
if (is_array ($matches)) {
	foreach ($matches as $filename) {
		echo "$filename (" . filesize($filename) . " bytes)&lt;br&gt;";
	}
}</code></pre><p>Applying the same test as above, an ideal result is (once more):</p><p class="echo">file-1.txt (136 bytes)<br>file-2.txt (262 bytes)<br>file-3.txt (1668 bytes)<br></p><h3>So, how many matching files are there?</h3><pre><code class="php">$matches = glob("*.txt"); // Assuming the same directory. Otherwise: ("/sub1/sub2/sub3/*.txt")
if (is_array ($matches)) {
	echo "There are " . count($matches) . " plain text files in the directory";
} else {
	echo 0; // Note that this does not explain possible error messages
}</code></pre><p>The script above should echo the number of matching files in the directory:</p><p class="echo">There are 3 plain text files in the directory</p><h3>Now, pick a random text file from an array of matching files and display the first 12 characters</h3><pre><code class="php">$matches = glob("*.txt");
if (is_array ($matches)) {
	$rndm = rand(1, count($matches));
	$filename = "file-" . $rndm . ".txt";
	$handle = fopen($filename, "r");
	$text = fread($handle, 12); // 12 bytes equals 12 characters. Note that we assume here that the file is at least that long
	fclose($handle);
	echo "The randomly selected file is " . $filename . " and the initial text is: " . $text . "&#8230;";
}</code></pre><p class="echo">The randomly selected file is file-3.txt and the initial text is: At vero eos &#8230;</p><p><strong>Note: </strong>This example does not check whether the file is at least 12 characters (bytes) long.</p><h3>Finally, pick a random text file from an array of matching files and display the whole text</h3><p><strong>1st Approach</strong></p><pre><code class="php">$matches = glob("*.txt");
if (is_array ($matches)) {
	$rndm = rand(1, count($matches));
	$filename = "file-" . $rndm . ".txt";
	$handle = fopen($filename, "r");
	$text = fread($handle, filesize($filename)); // This returns ALL of the text if bytes are not specified
	fclose($handle);
	echo "The randomly selected file is " . $filename . " and the contents are as follows: " . $text;
}</code></pre><p class="echo">The randomly selected file is file-1.txt and the contents are as follows: Lorem ipsum dolor sit amet, consectetur adipscing elit, sed diam nonnumy tempor incidunt ut labore et dolore magna aliquam erat volupat.</p><p><strong>2nd Approach</strong></p><p>When the goal is to get the <em>complete</em> contents of a file into a string, <code>file_get_contents()</code> has a better performance than the 1st approach:</p><pre><code class="php">$matches = glob("*.txt");
if (is_array ($matches)) {
	$rndm = rand(1, count($matches));
	$filename = "file-" . $rndm . ".txt";
	$text = file_get_contents($filename);
	echo "The randomly selected file is " . $filename . " and the contents are as follows: " . $text;
}</code></pre><p class="echo">The randomly selected file is file-1.txt and the contents are as follows: Lorem ipsum dolor sit amet, consectetur adipscing elit, sed diam nonnumy tempor incidunt ut labore et dolore magna aliquam erat volupat.</p></article><footer class="cL cntr">Impossiblue &#169; Bj√∏rn Sortland</footer><noscript class="cntr">This site is shite without JavaScript</noscript></div><script src="https://code.jquery.com/jquery-2.2.4.min.js"></script><script>window.jQuery || document.write('<script src="../../js/jquery.min.js"><\/script>')</script>
<script src="../../js/highlight.pack.js"></script><!-- 9.9.0 - Custom-built for HTML, XML, CSS, JavaScript, and PHP -->
<script>var pseudo=true;$("nav button").click(function(){$("nav ul").toggle("fast");if(pseudo===true){$("nav button").addClass("noPseudo");pseudo=false;}else{$("nav button").removeClass("noPseudo");pseudo=true;}$("nav button div").toggle("fast");});$("pre code").each(function(i,block){hljs.highlightBlock(block);});</script></body></html>