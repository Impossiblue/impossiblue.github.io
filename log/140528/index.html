<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Impossiblue: Noisy canvas - Dynamic</title><meta name="description" content="How to create dynamic, aka animated, noise with JavaScript and the canvas element. Overlaying the noise with a CSS transform animation is perfect for simulating no-signal TV reception. A fall-back GIF animation method is also provided."><meta name="author" content="https://impossiblue.github.io"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Impossiblue"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="apple-touch-icon" sizes="152x152" href="../../touch-icon-ipad.png"><link rel="apple-touch-startup-image" media="(device-width:768px) and (device-height:1024px) and (-webkit-device-pixel-ratio:2) and (orientation:portrait)" href="../../start-up-1536x2008.png"><link rel="apple-touch-startup-image" media="(device-width:768px) and (device-height:1024px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="../../start-up-1496x2048.png"><link rel="stylesheet" href="../../css/i.css"><!--[if lt IE 10]><link rel="stylesheet" href="../../css/ie.css"><![endif]--><style>aside::after{content:"5 March, 2017";}h2+p{color:rgba(0,0,0,.24);}article div{width:260px;height:120px;margin-top:1.5em;border:1px solid #eef5df;overflow:hidden;}#n1,#n2,#n4{background-color:#fff;}#tv{position:relative;}article div span{position:absolute;bottom:-36px;left:0;width:100%;height:36px;background-color:rgba(0,0,0,.12);-webkit-animation:move 3s linear infinite;animation:move 3s linear infinite;}@keyframes move{100%{-webkit-transform:translate(0,-156px);transform:translate(0,-156px);}}@-webkit-keyframes move{100%{-webkit-transform:translate(0,-156px);transform:translate(0,-156px);}}#gif{background-image:url("noise.gif");}@media only screen and (min-width:450px) and (max-width:589px){article div{width:400px;}}@media only screen and (min-width:590px) and (max-width:729px){article div{width:540px;}}@media only screen and (min-width:730px) and (max-width:869px){article div{width:680px;}}@media only screen and (min-width:870px) and (max-width:997px){article div{width:820px;}}@media only screen and (min-width:998px){article div{width:960px;}}</style></head><body><div id="ie">With geriatric Internet Explorer versions this site looks shite. This because Impossiblue is built with modern tools and would require hacks and workarounds to function in legacy browsers. I no longer have the patience nor the inclination to satisfy everybody. Impossiblue is an experiment and a playground &#8211;&#160;and my sustenance does not depend on it. As a concequence &#8211;&#160;to embarrass nobody &#8211;&#160;I have decided to lock you out. So, there.</div><div id="wrapper"><aside>10</aside><header id="masthead"><h1><a href="../../index.html">Impossiblue</a></h1></header><nav><button class="goEast" title="Menu">Open menu<div></div></button><a id="at" class="goEast" href="../../form.html" title="Contact us">Open form</a><ul>
<li class="ctgr"><b>&#9662;&#8194;</b><strong>Lorem ipsums</strong></li>
<li><a href="../210310/index.html">The secret six</a></li>
<li><a href="../210305/index.html">CSS background &#8211; Part 1</a></li>
<li><a href="../210325/index.html">CSS background &#8211; Part 2</a></li>
<li><a href="../170505/index.html">A pure CSS modal window</a></li>
<li><a href="../170420-2/index.html"><code>box-shadow</code></a></li>
<li><a href="../170414/index.html">Putting the &#8220;Checkbox hack&#8221; to good use</a></li>
<li><a href="../170420/index.html">Greyscale</a></li>
<li><a href="../170404-2/index.html">Sepia</a></li>
<li><a href="../170404/index.html">Background gradients</a></li>
<li><a href="../170326/index.html">Pseudo-elements and the image tag</a></li>
<li><a href="../170308/index.html">Styling an HTML <code>input</code> element</a></li>
<li><a href="../150504/index.html">How to add and centre a custom iPad wallpaper</a></li>
<li><a href="../150421-2/index.html">How to make a screen dump on an iPad</a></li>
<li><a href="../150421/index.html">How to permanently delete pictures from an iPad</a></li>
<li><a href="../140502/index.html">PHP &#8211; Random image</a></li>
<li><a href="../140426/index.html">PHP &#8211; How to get the width and height of an image</a></li>
<li><a href="../140423/index.html">PHP &#8211; Random quote</a></li>
<li><a href="../140420/index.html">PHP &#8211; How to find pathnames matching a pattern</a></li>
<li><a href="../141026/index.html">How to design a close-button with CSS</a></li>
<li><a href="../140625/index.html">Film grain &#8211; Sort of</a></li>
<li id="crrnt"><b>&#9656;&#8194;</b>Noisy canvas &#8211; Dynamic</li>
<li><a href="../140328/index.html">How to create a composite layer in Photoshop</a></li>
<li><a href="../140312/index.html">Noisy background &#8211; Static</a></li>
<li><a href="../100828/index.html">How to crop a movie with QuickTime Pro</a></li>
<li><a href="../060216/index.html">Gradient mosaic</a></li>
<li class="ctgr"><b>&#9662;&#8194;</b><strong>Rants and raves</strong></li>
<li><a href="../170417-2/index.html"><code>clip-path</code> &#8211; Part 2</a></li>
<li><a href="../170417/index.html"><code>clip-path</code> &#8211; Part 1</a></li>
<li><a href="../170322/index.html">Rapha&#235;l or Thinking outside the box</a></li>
<li><a href="../150907/index.html">Jan Kj√¶rstad &#8211;&#160;Storyteller</a></li>
<li><a href="../150504-2/index.html">Rain on a window pane &#8211;&#160;JavaScript simulation</a></li>
<li><a href="../170315/index.html">CSS throbbers &#8211;&#160;Part 3</a></li>
<li><a href="../150503/index.html">CSS throbbers &#8211;&#160;Part 2</a></li>
<li><a href="../150407/index.html">CSS throbbers &#8211;&#160;Part 1</a></li>
<li><a href="../150406/index.html">ResEdit and the recreation of the Mac OS wristwatch cursor animation</a></li>
<li><a href="../141108/index.html">Kaja Norum</a></li>
<li><a href="../141010/index.html">Kurt &#38; Kara <i>c</i> 1984</a></li>
<li><a href="../140627/index.html">Canvas and the Close Pixelate script</a></li>
<li><a href="../140405/index.html">Web Audio API &#8211; 1st Approach</a></li>
<li><a href="../140329/index.html">Audio visualizer &#8211; Atomic</a></li>
<li><a href="../140329/starfield.html">Audio visualizer &#8211; Star field</a></li>
<li><a href="../140323/index.html">Flash <i>in memoriam</i></a></li>
<li class="ctgr"><b>&#9662;&#8194;</b><strong>Notes to self</strong></li>
<li><a href="../150504-3/index.html">Ordnance Survey map of Great Britain</a></li>
<li><a href="../170530/index.html">Linking from SVG</a></li>
<li><a href="../170506/index.html">SVG in HTML and CSS</a></li>
<li><a href="../170429/index.html">Resize video <i>in situ</i></a></li>
<li><a href="../170425/index.html">Testing jQuery UI <code>draggable()</code></a></li>
<li><a href="../170424/index.html"><code>backdrop-filter: blur()</code></a></li>
<li><a href="../170422/index.html">Testing <code>sketch.js</code> &#8211;&#160;Particles</a></li>
<li><a href="../170404-3/index.html">Responsive images</a></li>
<li><a href="../170313/index.html">Pure CSS shapes</a></li>
<li><a href="../210308/index.html">A CSS TV-screen</a></li>
<li><a href="../170307/index.html">q</a></li>
<li><a href="../150511/index.html">xStand for iPad &#8211;&#160;The missing user manual</a></li>
<li><a href="../140628/index.html">CSS blur animation</a></li>
<li><a href="../150501/index.html">The CSS rule</a></li>
<li><a href="../170408/index.html">On forms and tables</a></li>
<li><a href="../140319/index.html">On animated cursors</a></li>
<li><a href="../150618/index.html">The concerts</a></li>
</ul></nav><article><h2>Noisy canvas &#8211; Dynamic</h2><p>First published on Ka of Isis 140528</p><p class="drpcp">This is a follow-up to an earlier article, <a href="../140312/index.html"><i>Noisy background &#8211;&#160;Static</i></a>. As the title of that article suggests, the main goal at the time was to fill a container with, well, static noise. The present article will take the concept one step further, and knowing full well that future search engine results will suggest this work for anything connected to dynamic <em>audio</em> noise, I just could not resist the temptation to use the term <i>dynamic</i> as opposed to <i>static</i>. <em>Animated</em> might have been more proper.</p><p>The work is based on a discussion at <a href="http://stackoverflow.com/questions/22003491/animating-canvas-to-look-like-tv-noise">Stack Overflow</a> and each technique has already been described in enough detail to render rants from this author superfluous. The first two examples were suggested by Ken Fyrstemberg, aka Epistemex, and shown in the jsfiddle demostrations <a href="http://jsfiddle.net/AbdiasSoftware/vX7NK/">TV noise (SO)</a> and <a href="http://jsfiddle.net/AbdiasSoftware/FrMNL/">TV noise analouge (SO) Fast</a>. The third technique was contributed by John Bupit with an accompanying <a href="http://jsfiddle.net/yeXQz/">jsfiddle demo</a>. Please study the source code for the web page you are currently on, for implementation on Impossiblue.</p><p><strong>Note: </strong>Fyrstemberg presents pure JavaScript methods that completely fill the viewport with noise. Bupit depends on the jQuery library and restricts the noise to a smaller <code>canvas</code> container. Remember that the <code>canvas</code> element uses a set number of pixels based on its width and height, and if scaled, this will ultimately scale its contents. This is a limitation if the <code>canvas</code> is used in responsive web layouts. Special considerations for this are not discussed here. Instead, each <code>canvas</code> tag is dropped into a wrapping <code>div</code> tag and extraneous <code>canvas</code> noise is hidden from view with <code>overflow:hidden</code> in CSS whenever the width of the wrapper is smaller than the set maximum.</p><h3>Method 1 &#8211;&#160;No-nonsense noise</h3><div><canvas id="n1" width="960" height="120"></canvas></div><p class="fig">Fig. If you see no noise above, your browser probably does not support the <code>canvas</code> element.</p><h3>Method 2 &#8211;&#160;Closer to TV noise</h3><div><canvas id="n2" width="960" height="120"></canvas></div><p class="fig">Fig. If noise can be clean, this is it!</p><h3>Method 3 &#8211;&#160;Bad TV reception</h3><div><canvas id="n3" width="960" height="120"></canvas></div><p class="fig">Fig. The noise is overlayed with a moving sinusoidal wave. There is a slight (unintentional) time-based jump in the animation, but that only adds to the realism.</p><p>John Bupit explains: &#8216;I set each pixel random value, and &#8230; overlayed a sinusodial (sic) wave that traveled upwards with time just to make it look more realistic. You can play with the constants in the wave to get different effects.&#8217;</p><h3>Method 4 &#8211;&#160;Bad TV reception with CSS animation</h3><div id="tv"><canvas id="n4" width="960" height="120"></canvas><span></span></div><p class="fig">Fig. My own humble contribution; Method 2 overlayed with a CSS transform animation.</p><h3>Method 5 &#8211;&#160;GIF animation</h3><div id="gif"></div><p class="fig">Fig. Easy to forget on the bleeding edge, but a GIF animation may be all that is needed &#8211;&#160;at times. No <code>canvas</code> here!</p><p>A flimsy tutorial on how the GIF animation came to life:</p><p>1. Photoshop &#8211;&#160;RGB &#8211;&#160;960x120&#160;pixels &#8211;&#160;White background.</p><p>2. With black as the foreground colour: <code>Filter &#62; Noise &#62; Add Noise&#8230;</code></p><img class="b0" src="an.png" alt="Screendump"><p>3. Duplicate the (now noisy) background (aka the 1st layer) and rotate it 180&#176;. This becomes the 2nd layer.</p><p>4. Again duplicate the 1st layer and flip horizontally. This becomes the 3rd layer.</p><p>5. Duplicate the 2nd layer and flip horizontally. This becomes the 4th layer.</p><p>6. Save each layer independently as a TIF/LZW image.</p><p><strong>Note: </strong>From now on, the order of the layers is really not important, but if you still follow me&#8230;</p><p>7. Open the 1st layer in Fireworks and add a new (empty) state.</p><p>8. Open the 2nd Photoshop TIF in Fireworks and drag the image into the empty Fireworks state.</p><p>9. Repeat for the remaining two TIFs. The original Fireworks file now has four states.</p><p>10. Shift-select all four states in the <code>STATES</code> panel and choose <code>Properties&#8230;</code> from the panel&#8217;s fly-out menu.</p><p>11. Add state delay as shown below:</p><img class="b0" src="sd.png" alt="Screendump"><p>12. Save as an animated GIF with an adaptive palette, witout dither, no transparency and no image preview, and let the application remove unused colours.</p><p>If the randomness is not random enough, <em>do</em> add layers/states but remember that the file size will grow. Animated GIFs work in Siberia if need be, but they are inflexible when compared to the JavaScript/canvas combination.</p></article><footer class="cL cntr">Impossiblue &#169; Bj√∏rn Sortland</footer><noscript class="cntr">This site is shite without JavaScript</noscript></div><script src="https://code.jquery.com/jquery-2.2.4.min.js"></script><script>window.jQuery || document.write('<script src="../../js/jquery.min.js"><\/script>')</script><script>var pseudo=true;$("nav button").click(function(){$("nav ul").toggle("fast");if(pseudo===true){$("nav button").addClass("noPseudo");pseudo=false;}else{$("nav button").removeClass("noPseudo");pseudo=true;}$("nav button div").toggle("fast");});
//	START Method 3. Dependency: jQuery. Based on: http://jsfiddle.net/yeXQz/

var canvas = null, context = null, time = 0, intervalId = 0;
var makeNoise = function() {
	var imgd = context.createImageData(canvas.width, canvas.height), pix = imgd.data;
	for(var i = 0, n = pix.length; i < n; i += 4) {
		var c = 7 + Math.sin(i/50000 + time/7); // A sine wave in the form sin(ax + bt)
		pix[i] = pix[i+1] = pix[i+2] = 40*Math.random()*c; // Random gray
		pix[i+3] = 255; // 100% opaque
	}
	context.putImageData(imgd, 0, 0);
	time = (time + 1) % canvas.height;
}
var setup = function() {
	canvas = document.getElementById("n3");
	context = canvas.getContext("2d");
}
setup();
intervalId = setInterval(makeNoise, 50);

//	END Method 3

window.onload = function() {

//	START Method 1. Based on: http://jsfiddle.net/AbdiasSoftware/vX7NK/

	var canvas = document.getElementById("n1"), ctx = canvas.getContext("2d");
	function noise(ctx) {
		var w = ctx.canvas.width, h = ctx.canvas.height, idata = ctx.createImageData(w, h), buffer32 = new Uint32Array(idata.data.buffer), len = buffer32.length, i = 0;
		for(; i < len;)
			buffer32[i++] = ((255 * Math.random())|0) << 24; // Alter alpha channel
		ctx.putImageData(idata, 0, 0);
	}
	var toggle = true; // To get 30 fps instead of 60 fps
	(function loop() {
		toggle = !toggle;
		if(toggle) {
			requestAnimationFrame(loop);
			return;
		}
		noise(ctx);
		requestAnimationFrame(loop);
	})();

//	END Method 1

//	START Method 2. Modified from: http://jsfiddle.net/AbdiasSoftware/FrMNL/

//	Note: Variable names etc have been modified so as not to conflict with Method 1
	var canvas2 = document.getElementById("n2"), ctx2 = canvas2.getContext("2d");
	function noise2(ctx2) {
		var w2 = ctx2.canvas.width, h2 = ctx2.canvas.height, idata2 = ctx2.createImageData(w2, h2), buffer32_2 = new Uint32Array(idata2.data.buffer), len2 = buffer32_2.length, i2 = 0;
		for(; i2 < len2;i2++)
			if(Math.random() < .5) buffer32_2[i2] = 0xff000000;
		ctx2.putImageData(idata2, 0, 0);
	}
	var toggle2 = true;
	(function loop2() {
		toggle2 = !toggle2;
		if(toggle2) {
			requestAnimationFrame(loop2);
			return;
		}
		noise2(ctx2);
		requestAnimationFrame(loop2);
	})();

//	END Method 2

//	START Method 4 (Method 2 overlayed with a CSS animation; see styles above)
	var canvas4 = document.getElementById("n4"), ctx4 = canvas4.getContext("2d");
	function noise4(ctx4) {
		var w4 = ctx4.canvas.width, h4 = ctx4.canvas.height, idata4 = ctx4.createImageData(w4, h4), buffer32_4 = new Uint32Array(idata4.data.buffer), len4 = buffer32_4.length, i4 = 0;
		for(; i4 < len4;i4++)
			if(Math.random() < .5) buffer32_4[i4] = 0xff000000;
		ctx4.putImageData(idata4, 0, 0);
	}
	var toggle4 = true;
	(function loop4() {
		toggle4 = !toggle4;
		if(toggle4) {
			requestAnimationFrame(loop4);
			return;
		}
		noise4(ctx4);
		requestAnimationFrame(loop4);
	})();

//	END Method 4

} // END window.onload</script></body></html>