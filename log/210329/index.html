<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Impossiblue: Masking video artefacts</title><meta name="description" content="How to hide border rubbish from video and play and pause with custom controls."><meta name="author" content="https://impossiblue.github.io"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Impossiblue"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="apple-touch-icon" sizes="152x152" href="../../touch-icon-ipad.png"><link rel="apple-touch-startup-image" media="(device-width:768px) and (device-height:1024px) and (-webkit-device-pixel-ratio:2) and (orientation:portrait)" href="../../start-up-1536x2008.png"><link rel="apple-touch-startup-image" media="(device-width:768px) and (device-height:1024px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="../../start-up-1496x2048.png"><link rel="stylesheet" href="../../css/i.css"><!--[if lt IE 10]><link rel="stylesheet" href="../../css/ie.css"><![endif]--><style>aside::after{content:"29 March, 2021";}form input{margin:1em auto 0;}</style></head><body><div id="ie">With geriatric Internet Explorer versions this site looks shite. This because Impossiblue is built with modern tools and would require hacks and workarounds to function in legacy browsers. I no longer have the patience nor the inclination to satisfy everybody. Impossiblue is an experiment and a playground &#8211;&#160;and my sustenance does not depend on it. As a concequence &#8211;&#160;to embarrass nobody &#8211;&#160;I have decided to lock you out. So, there.</div><div id="wrapper"><aside>59</aside><header id="masthead"><h1><a href="../../index.html">Impossiblue</a></h1></header><nav><button class="goEast" title="Menu">Open menu<div></div></button><a id="at" class="goEast" href="../../form.html" title="Contact us">Open form</a><ul>
<li class="ctgr"><b>&#9662;&#8194;</b><strong>Lorem ipsums</strong></li>
<li id="crrnt"><b>&#9656;&#8194;</b>Masking video artefacts</li>
<li><a href="../210326/index.html">Google&#8217;s material icons</a></li>
<li><a href="../210310/index.html">The secret six</a></li>
<li><a href="../210305/index.html">CSS background &#8211; Part 1</a></li>
<li><a href="../210325/index.html">CSS background &#8211; Part 2</a></li>
<li><a href="../170505/index.html">A pure CSS modal window</a></li>
<li><a href="../170420-2/index.html"><code>box-shadow</code></a></li>
<li><a href="../170414/index.html">Putting the &#8220;Checkbox hack&#8221; to good use</a></li>
<li><a href="../170420/index.html">Greyscale</a></li>
<li><a href="../170404-2/index.html">Sepia</a></li>
<li><a href="../170404/index.html">Background gradients</a></li>
<li><a href="../170326/index.html">Pseudo-elements and the image tag</a></li>
<li><a href="../170308/index.html">Styling an HTML <code>input</code> element</a></li>
<li><a href="../150504/index.html">How to add and centre a custom iPad wallpaper</a></li>
<li><a href="../150421-2/index.html">How to make a screen dump on an iPad</a></li>
<li><a href="../150421/index.html">How to permanently delete pictures from an iPad</a></li>
<li><a href="../140502/index.html">PHP &#8211; Random image</a></li>
<li><a href="../140426/index.html">PHP &#8211; How to get the width and height of an image</a></li>
<li><a href="../140423/index.html">PHP &#8211; Random quote</a></li>
<li><a href="../140420/index.html">PHP &#8211; How to find pathnames matching a pattern</a></li>
<li><a href="../141026/index.html">How to design a close-button with CSS</a></li>
<li><a href="../140625/index.html">Film grain &#8211; Sort of</a></li>
<li><a href="../140528/index.html">Noisy canvas &#8211; Dynamic</a></li>
<li><a href="../140328/index.html">How to create a composite layer in Photoshop</a></li>
<li><a href="../140312/index.html">Noisy background &#8211; Static</a></li>
<li><a href="../100828/index.html">How to crop a movie with QuickTime Pro</a></li>
<li><a href="../060216/index.html">Gradient mosaic</a></li>
<li class="ctgr"><b>&#9662;&#8194;</b><strong>Rants and raves</strong></li>
<li><a href="../170417-2/index.html"><code>clip-path</code> &#8211; Part 2</a></li>
<li><a href="../170417/index.html"><code>clip-path</code> &#8211; Part 1</a></li>
<li><a href="../170322/index.html">Rapha&#235;l or Thinking outside the box</a></li>
<li><a href="../150907/index.html">Jan Kj√¶rstad &#8211;&#160;Storyteller</a></li>
<li><a href="../150504-2/index.html">Rain on a window pane &#8211;&#160;JavaScript simulation</a></li>
<li><a href="../170315/index.html">CSS throbbers &#8211;&#160;Part 3</a></li>
<li><a href="../150503/index.html">CSS throbbers &#8211;&#160;Part 2</a></li>
<li><a href="../150407/index.html">CSS throbbers &#8211;&#160;Part 1</a></li>
<li><a href="../150406/index.html">ResEdit and the recreation of the Mac OS wristwatch cursor animation</a></li>
<li><a href="../141108/index.html">Kaja Norum</a></li>
<li><a href="../141010/index.html">Kurt &#38; Kara <i>c</i> 1984</a></li>
<li><a href="../140627/index.html">Canvas and the Close Pixelate script</a></li>
<li><a href="../140405/index.html">Web Audio API &#8211; 1st Approach</a></li>
<li><a href="../140329/index.html">Audio visualizer &#8211; Atomic</a></li>
<li><a href="../140323/index.html">Flash <i>in memoriam</i></a></li>
<li class="ctgr"><b>&#9662;&#8194;</b><strong>Notes to self</strong></li>
<li><a href="../150504-3/index.html">Ordnance Survey map of Great Britain</a></li>
<li><a href="../170530/index.html">Linking from SVG</a></li>
<li><a href="../170506/index.html">SVG in HTML and CSS</a></li>
<li><a href="../170429/index.html">Resize video <i>in situ</i></a></li>
<li><a href="../170425/index.html">Testing jQuery UI <code>draggable()</code></a></li>
<li><a href="../170424/index.html"><code>backdrop-filter: blur()</code></a></li>
<li><a href="../170422/index.html">Testing <code>sketch.js</code> &#8211;&#160;Particles</a></li>
<li><a href="../170404-3/index.html">Responsive images</a></li>
<li><a href="../170313/index.html">Pure CSS shapes</a></li>
<li><a href="../210308/index.html">A CSS TV-screen</a></li>
<li><a href="../170307/index.html">q</a></li>
<li><a href="../150511/index.html">xStand for iPad &#8211;&#160;The missing user manual</a></li>
<li><a href="../140628/index.html">CSS blur animation</a></li>
<li><a href="../150501/index.html">The CSS rule</a></li>
<li><a href="../170408/index.html">On forms and tables</a></li>
<li><a href="../140319/index.html">On animated cursors</a></li>
<li><a href="../150618/index.html">The concerts</a></li>
</ul></nav><article><h2>Masking video artefacts</h2><h3>The problem</h3><p class="drpcp">I &#8194;needed to show a YouTube video to prove a point in a presentation. The video, however, was of low quality, was not cropped correctly, and had flickering video artefacts at the bottom. Being of a rather pedantic character, I decided to spend hours rectifying the more obvious shortcomings of the video; all for the few minutes it would take to show it to my audience. Finally I ended up spending even more precious time to explain my procedure here.</p><img src="artefacts.jpg" alt="Still from video"><p class="fig">Fig. 1. The original 640x480 pixels video with border artefacts top, right and bottom.</p><p>With a higher quality video I would probably have used video software to get rid of the annoying borders, but the crappy quality of the original would have suffered further disintegration by an additional compression. HTML and CSS to the rescue, helped by a few lines of JavaScript.</p><p><strong>Note: </strong>For this to work (without generic <code>div</code> tags) the browser must recognize the HTML5+ <code>figure</code>, <code>video</code>, and <code>figcaption</code> tags, and the <code>calc()</code> function in CSS3+. And JavaScript must be enabled. Note also that the provided video example is in the MP4 format. As this will not play in all browsers, a production web page should offer options like WebM and OGG.</p><h3>A solution</h3><p>Embedding a <code>video</code> tag inside a <code>figure</code> tag inside an <code>html</code> tag, achieves two things: Semantic logic is built right in, and <code>figure</code> can be used as a parent for <code>video</code>, hiding (in our case) crap by specifying <code>overflow:hidden</code> in CSS.</p><p>In theory, our video could be positioned within a 640-30=<strong>610</strong> by 480-8-12=<strong>460</strong> pixels <code>figure</code> container, thus camouflaging all artefacts. The only problem being that once controls are speced in the video tag, they would be partly hidden, be visually ugly and difficult or impossible to operate.</p><img src="controls.png" alt="Partly hidden video controls"><p class="fig">Fig. 2. Controls partly masked out in Safari.</p><p>The following may sound counterproductive, but what if we scrap the default controls and add our own? And use <code>figcaption</code> (which is also within the <code>figure</code> container) as a wrapper for controls as well as caption text? This is doable if the <code>figcaption</code> (positioned higher in the stack than the video) is pushed upwards, hiding bottom crap in the video. An added benefit (or excuse) is that custom controls allow for identical visual appearance in a plethora of browsers.</p><p>My initial thought was to use an icon font for play and pause &#8220;buttons&#8221;, building on an earlier article on <a href="../210326/index.html">Google&#8217;s material icons</a>. Icon fonts have technical ideographs with (more or less) true and tested symbols. Ideographs behave like other characters in in-line text and can be easily hovered over and colourized. Another option would be to use a font with perceived Unicode alternatives, e.g. the <strong>Black right-pointing triangle</strong> (&#9654;, <code>&#38;&#35;9654;</code>) to allude a play button and a <strong>Black square</strong> (&#9724;, <code>&#38;&#35;9724;</code>) to stop the video along the way. Note that the <strong>Double vertical bar</strong> (aka <strong>Pause</strong>, <code>&#38;&#35;9208;</code>) was only passed by Unicode in 2014 and is even more rare than the triangle and square in many fonts. The latter two have been with us since 1993.</p><p>As an afterthought to said article, I must admit that I now lean towards SVG with theses material icons. The Google repository lacks font formats to support all browsers in general and it is huge; the filled regular version clocks in at 231 kB with its close to 1000 designs, the main part of which I will never need. Astronomic compared to in-line SVG (which does not require an additional HTTP request either). I have the discomforting feeling that the repository is no longer updated, both because of the lack of font format alternatives and the fact that the icons make use of the <code><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/enable-background">enable-background</a></code> attribute which has been deprecated since SVG 2.</p><p>Downsides of in-line SVG are that <strong>a)</strong> more thought (discussable, of course) needs to go into its implementation, <strong>b)</strong> the browser can not cache the code (as it would a normal, external image), and <strong>c)</strong> for larger images the encoded URL can become exhaustively long (i.e. it makes for a visually intricate HTML).</p><p>To circumvent the font problem for this here implementation, I decided to use in-line SVG code ripped from the <a href="https://fonts.google.com/icons">SVG versions</a> of the material icons <strong>Play circle filled</strong> and <strong>Pause circle filled</strong>.</p><h3>The custom controls</h3><p>Thus looks a regular HTML5 video tag <em>with</em> controls:</p><pre><code class="html">&lt;video src="...&#91;path to video&#93;.../myVideo.mp4" type="video/mp4" width="640" height="480" poster="...&#91;path to image&#93;.../image.jpg" controls preload="none"&gt;&lt;/video&gt;</code></pre><p>In the accompanying demo, preloading is not activated. Both because the video is merely a snippet but also because of the fact that not all users will get to the point of actually running it. It may therefore be rude to spend their precious bandwidth mindlessly.</p><p>The type attribute (<code>type="video/mp4"</code>) has also been ditched. Even though it helps the user agent to determine if it can actually play a media resource before fetching it, this attribute makes most sense when dealing with multiple sources catering to different browsers.</p><p>And, the <code>controls</code> attribute goes missing because customization is the name of the game here.</p><p>To visually indicate what the video is (more or less) about, a poster image of Mozart has been speced in the video tag.</p><h3>Final code</h3><p>Demo page <strong>HTML</strong>:</p><pre><code class="html">&lt;figure id="customControls"&gt;
	&lt;video src="vb.m4v" width="640" height="480" poster="mozart.jpg" preload="none"&gt;&lt;/video&gt;
	&lt;figcaption&gt;
		&lt;a href="#"&gt;
			&lt;svg id="startStop"&gt;&lt;path d="M0 0h24v24H0V0z" fill="none"/&gt;&lt;path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z"/&gt;&lt;/svg&gt;
		&lt;/a&gt;
		Victor Borge on Mozart
	&lt;/figcaption&gt;
&lt;/figure&gt;</code></pre><p>The accompanying <strong>CSS</strong> (see page source for comments):</p><pre><code class="css">figure {
	position: absolute; top: 0; right: 0; bottom: 0; left: 0; margin: auto;
	width: calc(640px - 30px);
	height: calc(480px - 8px - 12px + 36px);
	overflow: hidden;
	}
video {
	position: relative;
	top: -8px;
	left: 0;
	}
figcaption {
	position: absolute;
	top: calc(480px - 8px - 12px);
	width: calc(640px - 30px);
	height: 36px;
	font-size: 1.8rem;
	line-height: 36px;
	color: #eef5df;
	background-color: #000;
	}
svg {
	position: relative;
	top: .3em;
	width: 24px;
	height: 24px;
	margin: 0 .5em;
	fill: #475f14;
	}</code></pre><p>The necessary <strong>JavaScript</strong> (see page source for comments and references):</p><pre><code class="javascript">var videoContainer = document.getElementById("customControls");
var video = videoContainer.querySelector("video");
var controls = videoContainer.querySelector("figcaption");
var playPause = controls.querySelector("a");
playPause.addEventListener("click", function(e) { 
	e.preventDefault()
	if (video.paused) {
		video.play();
		playPause.innerHTML = '&lt;svg id="startStop"&gt;&lt;g&gt;&lt;rect fill="none"/&gt;&lt;rect fill="none"/&gt;&lt;rect fill="none"/&gt;&lt;/g&gt;&lt;g&gt;&lt;g/&gt;&lt;path d="M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10s10-4.48,10-10S17.52,2,12,2z M11,16H9V8h2V16z M15,16h-2V8h2V16z"/&gt;&lt;/g&gt;&lt;/svg&gt;';
		document.getElementById("startStop").style.fill = "#900";
	} else {
		video.pause();
		playPause.innerHTML = '&lt;svg id="startStop"&gt;&lt;path d="M0 0h24v24H0V0z" fill="none"/&gt;&lt;path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z"/&gt;&lt;/svg&gt;';
		document.getElementById("startStop").style.fill = "#475f14";
}})
video.addEventListener("ended", theEnd, false);
function theEnd(e) {
	playPause.innerHTML = '&lt;svg id="startStop"&gt;&lt;path d="M0 0h24v24H0V0z" fill="none"/&gt;&lt;path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z"/&gt;&lt;/svg&gt;';
	document.getElementById("startStop").style.fill = "#475f14";
}</code></pre><form action="demo.html"><input type="submit" value="Demo"></form><h3>MP4 vs m4v</h3><p>The demo shows a 5 sec video saved out from the original video. This was done only to proof play/pause when testing; no need for the full video. The open-source <a href="https://handbrake.fr">HandBrake</a> video converter was used to generate the demo file &#8211; which has an <code>m4v</code> suffix. The developers state that M4V and MP4 &#8220;are the exact same file, the only difference is the extension.&#8221; Often it is possible to simply change the suffix, and the file/content will remain identical. At other times this is not possible. More to the point: M4V files may be protected by Apple&#8217;s digital rights management. Renaming to <code>mp4</code> will then not work. Neither can the file itself be manipulated as the content is encrypted and only playable with Apple-software on the machine it was bought on.</p><p>The original video can be seen on <a href="https://www.youtube.com/watch?v=RtDX1Vl-Jxk">YouTube</a>.</p><h3>A note on <code>rem</code></h3><p>The font size in the figure caption on the demo page is set with a <code>rem</code> value. This is only a matter of convenience because <code>rem</code> kills cascading dependencies. No need then, to worry about size whenever a caption is used inside of whatever parent element. With <code>rem</code>, browsers default to root (i.e. <code>1rem</code> equals <code>16px</code>). While <code>em</code> or <code>%</code> is relative to the font size of its direct or nearest parent, <code>rem</code> is only relative to the <code>html</code> (root) font size. On the demo page, <code>html</code> is set to a font size of 62.5% (resetting browser std. to 10px) and the <code>figcaption</code> to 1.8rem. For the latter this computes to 16px*0.625*1.8 = 18px.</p><h3>Work in progress</h3><p>The glaring omission with this custom control is the lack of a scrubber; the means to skip parts of the video, to go back and forth. While I would normally mumble &#8216;He must nedys go that the deuell dryues.&#8217;, this has already been covered by more knowledgeable people than myself. Where, please, you may say? Well, in Basic programming one would use <code><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Audio_and_video_delivery/cross_browser_video_player" title="Creating a cross-browser video player">goto</a></code>.</article><footer class="cL cntr">Impossiblue &#169; Bj√∏rn Sortland</footer><noscript class="cntr">This site is shite without JavaScript</noscript></div><script src="https://code.jquery.com/jquery-2.2.4.min.js"></script><script>window.jQuery || document.write('<script src="../../js/jquery.min.js"><\/script>')</script><script src="../../js/highlight.pack.js"></script><script>var pseudo=true;$("nav button").click(function(){$("nav ul").toggle("fast");if(pseudo===true){$("nav button").addClass("noPseudo");pseudo=false;}else{$("nav button").removeClass("noPseudo");pseudo=true;}$("nav button div").toggle("fast");});$("pre code").each(function(i,block){hljs.highlightBlock(block);});q</script></body></html>